<!-- 守備・起用 -->

<div class="row p-2">
  <!-- 基礎能力部 -->
  <div class="col-3 pe-4 pawa-text-main">
    <%= render partial: 'pawapuro/players/details/foundation_ability_box', locals: {
      label: "走力",
      ability_value: details_ability_value_basic(@player.running)
    } %>
    <%= render partial: 'pawapuro/players/details/foundation_ability_box', locals: {
      label: "肩力",
      ability_value: details_ability_value_basic(@player.arm)
    } %>

    <!-- 各ポジション適正 -->
    <!-- PCサイズ時 -->
    <div class="d-none d-sm-block">
      <div class="d-flex justify-content-start row p-1 mb-1 pawa-main-box">
        <div class="col-6 d-flex align-items-center p-0">
          <div class="col-5 p-0">
            <div class="pawa-ability-label-no-value">守備力</div>
          </div>
        </div>
        <div class="col-6 ps-3 py-2 pawa-border-main border-bottom-0">
          <%= render partial: 'pawapuro/players/details/positional_appropriateness', locals: {
            position_abbreviation: "投",
            position_proficiency: @position_proficiencies
                                    .select { |pos| [10, 11, 12].include?(pos[:id]) }
                                    .map { |pos| pos[:proficiency] }
                                    .max || nil
          } %>
        </div>
        <div class="col-6 ps-3 py-2 pawa-border-main border-bottom-0 border-end-0">
          <%= render partial: 'pawapuro/players/details/positional_appropriateness', locals: {
            position_abbreviation: "捕",
            position_proficiency: @position_proficiencies.find { |pos| pos[:id] == 2 }&.dig(:proficiency) || nil
          } %>
        </div>
        <div class="col-6 ps-3 py-2 pawa-border-main border-bottom-0">
          <%= render partial: 'pawapuro/players/details/positional_appropriateness', locals: {
            position_abbreviation: "一",
            position_proficiency: @position_proficiencies.find { |pos| pos[:id] == 3 }&.dig(:proficiency) || nil
          } %>
        </div>
        <div class="col-6 ps-3 py-2 pawa-border-main border-bottom-0 border-end-0">
          <%= render partial: 'pawapuro/players/details/positional_appropriateness', locals: {
            position_abbreviation: "二",
            position_proficiency: @position_proficiencies.find { |pos| pos[:id] == 4 }&.dig(:proficiency) || nil
          } %>
        </div>
        <div class="col-6 ps-3 py-2 pawa-border-main border-bottom-0">
          <%= render partial: 'pawapuro/players/details/positional_appropriateness', locals: {
            position_abbreviation: "三",
            position_proficiency: @position_proficiencies.find { |pos| pos[:id] == 5 }&.dig(:proficiency) || nil
          } %>
        </div>
        <div class="col-6 ps-3 py-2 pawa-border-main border-end-0">
          <%= render partial: 'pawapuro/players/details/positional_appropriateness', locals: {
            position_abbreviation: "遊",
            position_proficiency: @position_proficiencies.find { |pos| pos[:id] == 6 }&.dig(:proficiency) || nil
          } %>
        </div>
        <div class="col-6 ps-3 py-2 pawa-border-main">
          <%= render partial: 'pawapuro/players/details/positional_appropriateness', locals: {
            position_abbreviation: "外",
            position_proficiency: @position_proficiencies.find { |pos| pos[:id] == 13 }&.dig(:proficiency) || nil
          } %>
        </div>
      </div>
    </div>
    <!-- スマホサイズ時 -->
    <div class="d-block d-sm-none">
      <div class="d-flex justify-content-start row p-1 mb-1 pawa-main-box">
        <div class="col-6 d-flex align-items-center p-0">
          <div class="col-5 p-0 mb-1">
            <div class="pawa-ability-label-no-value">守備力</div>
          </div>
        </div>
        <div class="col-12 py-2 pawa-border-main border-bottom-0">
          <%= render partial: 'pawapuro/players/details/positional_appropriateness', locals: {
            position_abbreviation: "投",
            position_proficiency: @position_proficiencies
                                    .select { |pos| [10, 11, 12].include?(pos[:id]) }
                                    .map { |pos| pos[:proficiency] }
                                    .max || nil
          } %>
        </div>
        <div class="col-12 py-2 pawa-border-main border-bottom-0">
          <%= render partial: 'pawapuro/players/details/positional_appropriateness', locals: {
            position_abbreviation: "捕",
            position_proficiency: @position_proficiencies.find { |pos| pos[:id] == 2 }&.dig(:proficiency) || nil
          } %>
        </div>
        <div class="col-12 py-2 pawa-border-main border-bottom-0">
          <%= render partial: 'pawapuro/players/details/positional_appropriateness', locals: {
            position_abbreviation: "一",
            position_proficiency: @position_proficiencies.find { |pos| pos[:id] == 3 }&.dig(:proficiency) || nil
          } %>
        </div>
        <div class="col-12 py-2 pawa-border-main border-bottom-0">
          <%= render partial: 'pawapuro/players/details/positional_appropriateness', locals: {
            position_abbreviation: "二",
            position_proficiency: @position_proficiencies.find { |pos| pos[:id] == 4 }&.dig(:proficiency) || nil
          } %>
        </div>
        <div class="col-12 py-2 pawa-border-main border-bottom-0">
          <%= render partial: 'pawapuro/players/details/positional_appropriateness', locals: {
            position_abbreviation: "三",
            position_proficiency: @position_proficiencies.find { |pos| pos[:id] == 5 }&.dig(:proficiency) || nil
          } %>
        </div>
        <div class="col-12 py-2 pawa-border-main border-bottom-0">
          <%= render partial: 'pawapuro/players/details/positional_appropriateness', locals: {
            position_abbreviation: "遊",
            position_proficiency: @position_proficiencies.find { |pos| pos[:id] == 6 }&.dig(:proficiency) || nil
          } %>
        </div>
        <div class="col-12 py-2 pawa-border-main">
          <%= render partial: 'pawapuro/players/details/positional_appropriateness', locals: {
            position_abbreviation: "外",
            position_proficiency: @position_proficiencies.find { |pos| pos[:id] == 13 }&.dig(:proficiency) || nil
          } %>
        </div>
      </div>
    </div>
    <%= render partial: 'pawapuro/players/details/foundation_ability_box', locals: {
      label:"捕球",
      ability_value: details_ability_value_basic(@player.catching)
    } %>
  </div>

  <!-- 特殊能力部 -->
  <div class="col-9 bg-light border border-3 border-white rounded">
    <div class="row">
      <div class="col fs-3 bg-white pawa-border-main-in rounded">
        <div class="row pt-1 pb-1 ps-1 text-center">
          <span class="col-12 ps-2 pawa-text-main">起用</span>
        </div>
      </div>
      <div class="col fs-3 pawa-bg-sa-neutral1 rounded">
        <div class="row p-1 text-center">
          <span class="col-12 pawa-bg-sa-neutral2 rounded pawa-text-neutral">&nbsp;</span>
        </div>
      </div>
      <div class="col fs-3 pawa-bg-sa-neutral1 rounded">
        <div class="row p-1 text-center">
          <span class="col-12 pawa-bg-sa-neutral2 rounded pawa-text-neutral">&nbsp;</span>
        </div>
      </div>
      <div class="col fs-3 pawa-bg-sa-neutral1 rounded">
        <div class="row p-1 text-center">
          <span class="col-12 pawa-bg-sa-neutral2 rounded pawa-text-neutral">&nbsp;</span>
        </div>
      </div>
    </div>
    <div class="row">
      <div class="col fs-3 pawa-bg-sa-neutral1 rounded">
        <div class="row p-1 text-center">
          <span class="col-12 pawa-bg-sa-neutral2 rounded pawa-text-neutral">&nbsp;</span>
        </div>
      </div>
      <div class="col fs-3 pawa-bg-sa-neutral1 rounded">
        <div class="row p-1 text-center">
          <span class="col-12 pawa-bg-sa-neutral2 rounded pawa-text-neutral">&nbsp;</span>
        </div>
      </div>
      <div class="col fs-3 pawa-bg-sa-neutral1 rounded">
        <div class="row p-1 text-center">
          <span class="col-12 pawa-bg-sa-neutral2 rounded pawa-text-neutral">&nbsp;</span>
        </div>
      </div>
      <div class="col fs-3 pawa-bg-sa-neutral1 rounded">
        <div class="row p-1 text-center">
          <span class="col-12 pawa-bg-sa-neutral2 rounded pawa-text-neutral">&nbsp;</span>
        </div>
      </div>
    </div>

    <!-- 値なし -->
    <!-- TODO: 部分テンプレートに切り出し -->
    <% abilities_array = @player.other_special_abilities(110).concat(@player.other_special_abilities(140)) %>
    <% 6.times do |row| %>
      <div class="row">
        <% (row*4...row*4+4).each do |index| %>
          <%= render partial: 'pawapuro/players/details/basic_ability_box', locals: {
            ability_name: abilities_array[index]&.first,
            ability_good_bad_division: abilities_array[index]&.second
          } %>
        <% end %>
      </div>
    <% end %>
  </div>
</div>
